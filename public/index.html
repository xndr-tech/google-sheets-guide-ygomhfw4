<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets Guide - Master Google Sheets Formulas & Tutorials</title>
    <meta name="description" content="Unlock the full potential of Google Sheets with our extensive guide. Learn formulas, functions, and advanced techniques. Explore templates and interactive tools to simplify your data analysis and boost productivity.">
    <meta name="keywords" content="Google Sheets tutorial, Google Sheets formulas, learn Google Sheets, Google Sheets templates, REGEX Google Sheets, Google Sheets automation, data analysis, spreadsheet guide">
    <meta name="robots" content="index, follow">

    <!-- Open Graph Tags -->
    <meta property="og:title" content="Google Sheets Guide - Master Formulas & Tutorials">
    <meta property="og:description" content="Unlock the full potential of Google Sheets with our extensive guide. Learn formulas, functions, and advanced techniques. Explore templates and interactive tools to simplify your data analysis and boost productivity.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://sheetsguide.example.com">
    <meta property="og:image" content="https://sheetsguide.example.com/og-image.jpg"> <!-- Placeholder image URL -->

    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Google Sheets Guide - Master Formulas & Tutorials">
    <meta name="twitter:description" content="Unlock the full potential of Google Sheets with our extensive guide. Learn formulas, functions, and advanced techniques. Explore templates and interactive tools to simplify your data analysis and boost productivity.">

    <link rel="canonical" href="https://sheetsguide.example.com">

    <!-- Favicon - Inline SVG -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text x=%2250%%22 y=%2290%%22 style=%22font-size: 80px; font-family: 'Plus Jakarta Sans', sans-serif; fill: %235ba380; text-anchor: middle;%22>üìä</text></svg>">

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Google Sheets Guide",
      "url": "https://sheetsguide.example.com",
      "description": "An extensive guide on Google Sheets, featuring interactive tools for formula generation and REGEX building.",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://sheetsguide.example.com?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap');

        :root {
            --primary: #8ecfad;
            --secondary: #f0f7f4;
            --accent: #5ba380;
            --text-dark: #333333;
            --text-light: #ffffff;
            --background-light: #fdfdfd;
            --shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            --border-radius: 8px;
            --transition-speed: 0.3s;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            color: var(--text-dark);
            line-height: 1.6;
            background-color: var(--background-light);
        }

        a {
            text-decoration: none;
            color: var(--primary);
            transition: color var(--transition-speed);
        }

        a:hover {
            color: var(--accent);
        }

        h1, h2, h3, h4, h5, h6 {
            margin-bottom: 0.8em;
            font-weight: 700;
            line-height: 1.2;
        }

        h1 { font-size: 2.8em; }
        h2 { font-size: 2.2em; }
        h3 { font-size: 1.8em; }
        h4 { font-size: 1.4em; }

        p {
            margin-bottom: 1em;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1.5rem 1rem;
        }

        section {
            padding: 4rem 0;
            position: relative;
        }

        section:nth-of-type(even) {
            background-color: var(--secondary);
        }

        .btn {
            display: inline-block;
            background-color: var(--primary);
            color: var(--text-light);
            padding: 0.8rem 1.8rem;
            border-radius: var(--border-radius);
            font-weight: 600;
            transition: background-color var(--transition-speed), transform var(--transition-speed), box-shadow var(--transition-speed);
            border: none;
            cursor: pointer;
            text-align: center;
        }

        .btn:hover {
            background-color: var(--accent);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
            color: var(--text-light); /* Ensure text color remains light */
        }

        /* Header */
        #header {
            background-color: var(--text-light);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            padding: 1rem 0;
        }

        #header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 1rem;
        }

        .logo {
            font-size: 1.8em;
            font-weight: 700;
            color: var(--accent);
            transition: color var(--transition-speed);
        }

        .logo:hover {
            color: var(--primary);
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 1.5rem;
        }

        .nav-menu a {
            color: var(--text-dark);
            font-weight: 500;
            padding: 0.5rem 0;
            position: relative;
        }

        .nav-menu a::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 0;
            height: 2px;
            background-color: var(--accent);
            transition: width var(--transition-speed);
        }

        .nav-menu a:hover::after {
            width: 100%;
        }

        /* Hamburger Menu (Mobile) */
        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            gap: 5px;
            padding: 5px;
        }

        .hamburger .bar {
            width: 25px;
            height: 3px;
            background-color: var(--text-dark);
            border-radius: 5px;
            transition: all var(--transition-speed);
        }

        #nav-toggle {
            display: none; /* Hide the checkbox */
        }

        @media (max-width: 768px) {
            .hamburger {
                display: flex;
            }

            .nav-menu {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background-color: var(--text-light);
                box-shadow: var(--shadow);
                padding: 1rem 0;
                border-top: 1px solid var(--secondary);
            }

            .nav-menu li {
                text-align: center;
                margin: 0.5rem 0;
            }

            #nav-toggle:checked ~ .nav-menu {
                display: flex;
            }

            /* Hamburger animation */
            #nav-toggle:checked + .hamburger .bar:nth-child(1) {
                transform: rotate(-45deg) translate(-5px, 6px);
            }
            #nav-toggle:checked + .hamburger .bar:nth-child(2) {
                opacity: 0;
            }
            #nav-toggle:checked + .hamburger .bar:nth-child(3) {
                transform: rotate(45deg) translate(-5px, -6px);
            }
        }

        /* Hero Section */
        #hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: var(--text-light);
            min-height: 80vh; /* Adjusted to allow more content below if needed */
            display: flex;
            align-items: center;
            text-align: center;
        }

        #hero .container {
            padding: 4rem 1rem;
            max-width: 900px;
        }

        #hero h1 {
            font-size: clamp(2.5em, 6vw, 4em);
            margin-bottom: 0.5em;
            font-weight: 700;
        }

        #hero p {
            font-size: clamp(1.1em, 2.5vw, 1.5em);
            margin-bottom: 2em;
            font-weight: 300;
        }

        /* Interactive Tools (General Styling) */
        .tool-section {
            padding: 3rem 1.5rem;
            background-color: var(--background-light);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            text-align: left;
        }

        .tool-section h2 {
            text-align: center;
            color: var(--accent);
            margin-bottom: 1.5rem;
            font-size: 2em;
        }

        .tool-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .tool-form label {
            font-weight: 600;
            margin-bottom: 0.3rem;
            display: block;
            color: var(--text-dark);
        }

        .tool-form input[type="text"],
        .tool-form textarea,
        .tool-form select {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-family: 'Plus Jakarta Sans', sans-serif;
            font-size: 1em;
            transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
        }

        .tool-form input[type="text"]:focus,
        .tool-form textarea:focus,
        .tool-form select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(142, 207, 173, 0.2);
            outline: none;
        }

        .tool-form textarea {
            min-height: 100px;
            resize: vertical;
        }

        .tool-results {
            margin-top: 1.5rem;
            padding: 1rem 1.2rem;
            background-color: var(--secondary);
            border: 1px dashed var(--primary);
            border-radius: var(--border-radius);
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            word-break: break-all;
            position: relative;
        }

        .tool-results-label {
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 0.5rem;
            display: block;
        }

        .tool-results code {
            display: block;
            background-color: #e6e6e6;
            padding: 0.7rem;
            border-radius: 5px;
            overflow-x: auto;
            color: var(--text-dark);
        }

        .tool-error {
            color: #d9534f;
            background-color: #fce8e6;
            border: 1px solid #d9534f;
            padding: 0.7rem;
            border-radius: var(--border-radius);
            margin-top: 1rem;
            font-weight: 500;
        }

        .copy-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background-color: var(--primary);
            color: var(--text-light);
            padding: 0.3rem 0.6rem;
            border-radius: 5px;
            font-size: 0.8em;
            cursor: pointer;
            border: none;
            transition: background-color var(--transition-speed);
        }

        .copy-btn:hover {
            background-color: var(--accent);
        }

        /* Features Section */
        #features .container {
            text-align: center;
        }

        #features h2 {
            color: var(--primary);
            margin-bottom: 2.5rem;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .feature-card {
            background-color: var(--text-light);
            padding: 2rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            text-align: center;
            transition: transform var(--transition-speed), box-shadow var(--transition-speed);
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .feature-card .icon {
            font-size: 3em;
            color: var(--accent);
            margin-bottom: 0.8em;
            display: block;
        }

        .feature-card h3 {
            font-size: 1.4em;
            margin-bottom: 0.6em;
            color: var(--text-dark);
        }

        .feature-card p {
            font-size: 0.95em;
            color: #555;
        }

        /* About Section */
        #about .container {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            align-items: center;
            text-align: center;
        }

        #about h2 {
            color: var(--primary);
            margin-bottom: 1.5rem;
        }

        #about p {
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Contact Section */
        #contact .container {
            text-align: center;
        }

        #contact h2 {
            color: var(--primary);
            margin-bottom: 2.5rem;
        }

        .contact-content {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            justify-content: center;
            margin-top: 2rem;
        }

        .contact-form-container {
            flex: 1 1 400px;
            background-color: var(--text-light);
            padding: 2.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            text-align: left;
        }

        .contact-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .contact-form label {
            font-weight: 600;
            margin-bottom: 0.3rem;
            display: block;
        }

        .contact-form input[type="text"],
        .contact-form input[type="email"],
        .contact-form textarea {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-family: 'Plus Jakarta Sans', sans-serif;
            font-size: 1em;
            transition: border-color var(--transition-speed), box-shadow var(--transition-speed);
        }

        .contact-form input[type="text"]:focus,
        .contact-form input[type="email"]:focus,
        .contact-form textarea:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(142, 207, 173, 0.2);
            outline: none;
        }

        .contact-form textarea {
            min-height: 120px;
            resize: vertical;
        }

        .contact-info {
            flex: 1 1 300px;
            background-color: var(--secondary);
            padding: 2.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            text-align: left;
        }

        .contact-info h3 {
            color: var(--accent);
            margin-bottom: 1.5rem;
        }

        .contact-info p {
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }

        .contact-info p strong {
            color: var(--primary);
        }

        .social-links {
            margin-top: 1.5rem;
            display: flex;
            gap: 1rem;
            justify-content: flex-start;
        }

        .social-links a {
            font-size: 1.8em;
            color: var(--text-dark);
            transition: color var(--transition-speed);
        }

        .social-links a:hover {
            color: var(--primary);
        }

        /* Footer */
        footer {
            background-color: var(--text-dark);
            color: var(--text-light);
            padding: 3rem 0;
            text-align: center;
            font-size: 0.9em;
        }

        footer .container {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            align-items: center;
        }

        footer .footer-nav {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1.5rem;
        }

        footer .footer-nav a {
            color: var(--text-light);
            font-weight: 400;
        }

        footer .footer-nav a:hover {
            color: var(--primary);
        }

        footer .footer-social-links {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        footer .footer-social-links a {
            font-size: 1.5em;
            color: var(--text-light);
            transition: color var(--transition-speed);
        }

        footer .footer-social-links a:hover {
            color: var(--primary);
        }

        .back-to-top {
            display: block;
            margin-top: 1.5rem;
            color: var(--primary);
            font-weight: 500;
        }

        .back-to-top:hover {
            color: var(--accent);
        }

        /* General utility classes for icons (using emojis for simplicity) */
        .icon-email::before { content: 'üìß'; margin-right: 0.5em; }
        .icon-phone::before { content: 'üìû'; margin-right: 0.5em; }
        .icon-location::before { content: 'üìç'; margin-right: 0.5em; }
        .icon-twitter::before { content: 'üê¶'; }
        .icon-linkedin::before { content: 'üíº'; }
        .icon-github::before { content: 'üíª'; }
        .icon-facebook::before { content: 'üë§'; }

        /* Responsive adjustments */
        @media (min-width: 769px) {
            #hero {
                min-height: 100vh; /* Full viewport on larger screens */
            }
        }
        @media (max-width: 992px) {
            .container {
                padding: 1rem;
            }
            h1 { font-size: 2.5em; }
            h2 { font-size: 2em; }
            h3 { font-size: 1.6em; }
        }
        @media (max-width: 576px) {
            #header .container {
                flex-wrap: wrap;
                justify-content: center;
                gap: 1rem;
            }
            .logo {
                width: 100%;
                text-align: center;
            }
            .hamburger {
                order: 2;
            }
            .nav-menu {
                order: 3;
            }
            #hero h1 { font-size: 2em; }
            #hero p { font-size: 1em; }
            .features-grid {
                grid-template-columns: 1fr;
            }
            .contact-form-container, .contact-info {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <header id="header">
        <div class="container">
            <a href="#hero" class="logo">SheetsGuide</a>
            <input type="checkbox" id="nav-toggle">
            <label for="nav-toggle" class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </label>
            <nav>
                <ul class="nav-menu">
                    <li><a href="#hero">Home</a></li>
                    <li><a href="#formula-generator">Formula Generator</a></li>
                    <li><a href="#regex-builder">REGEX Builder</a></li>
                    <li><a href="#features">Features</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section id="hero">
            <div class="container">
                <h1>Master Google Sheets: Your Ultimate Guide & Interactive Tools</h1>
                <p>Unlock powerful data analysis and automation with our comprehensive tutorials and smart formula builders. Simplify complex tasks, boost your productivity, and excel with Google Sheets.</p>
                <a href="#formula-generator" class="btn">Start Building Formulas</a>
            </div>
        </section>

        <section id="formula-generator" class="tool-section">
            <div class="container">
                <h2>Google Sheets Formula Generator</h2>
                <p style="text-align: center; max-width: 700px; margin: 0 auto 2rem;">Describe your goal in plain language, and let our tool help you craft the perfect Google Sheets formula. We'll handle common scenarios to get you started efficiently.</p>
                <form id="formulaGenForm" class="tool-form">
                    <label for="formulaGoal">Describe your goal:</label>
                    <textarea id="formulaGoal" placeholder="E.g., 'sum column A if column B is Sales and column C is East', 'find unique values in column D', 'concatenate cells A2 and B2 with a space'"></textarea>

                    <label for="formulaHeaders">Example Headers (comma-separated, optional):</label>
                    <input type="text" id="formulaHeaders" placeholder="E.g., 'Product, Sales Rep, Region'">

                    <label for="formulaStartRow">Starting Row for Data (e.g., 2, if data starts below headers):</label>
                    <input type="number" id="formulaStartRow" value="2" min="1">

                    <button type="submit" class="btn">Generate Formula</button>
                </form>
                <div id="formulaResult" class="tool-results" style="display: none;">
                    <span class="tool-results-label">Generated Formula:</span>
                    <button class="copy-btn" onclick="copyToClipboard('formulaOutput')">Copy</button>
                    <code id="formulaOutput"></code>
                </div>
                <div id="formulaError" class="tool-error" style="display: none;"></div>
            </div>
        </section>

        <section id="regex-builder" class="tool-section">
            <div class="container">
                <h2>REGEX Formula Builder & Tester</h2>
                <p style="text-align: center; max-width: 700px; margin: 0 auto 2rem;">Build and test your regular expressions for Google Sheets functions like REGEXMATCH, REGEXEXTRACT, and REGEXREPLACE. Perfect your patterns with live feedback.</p>
                <form id="regexBuilderForm" class="tool-form">
                    <label for="regexPattern">REGEX Pattern:</label>
                    <input type="text" id="regexPattern" placeholder="E.g., \d{3}-\d{3}-\d{4} for phone numbers">

                    <label for="regexTestString">Test String:</label>
                    <textarea id="regexTestString" placeholder="E.g., 'My phone is 123-456-7890 and another is 987-654-3210'"></textarea>

                    <label for="regexFunction">Google Sheets Function:</label>
                    <select id="regexFunction">
                        <option value="REGEXMATCH">REGEXMATCH</option>
                        <option value="REGEXEXTRACT">REGEXEXTRACT</option>
                        <option value="REGEXREPLACE">REGEXREPLACE</option>
                    </select>

                    <div id="replaceField" style="display: none;">
                        <label for="regexReplacement">Replacement String (for REGEXREPLACE):</label>
                        <input type="text" id="regexReplacement" placeholder="E.g., 'XXX-XXX-XXXX'">
                    </div>

                    <button type="submit" class="btn">Test REGEX</button>
                </form>
                <div id="regexResult" class="tool-results" style="display: none;">
                    <span class="tool-results-label">Result:</span>
                    <button class="copy-btn" onclick="copyToClipboard('regexOutput')">Copy</button>
                    <code id="regexOutput"></code>
                </div>
                <div id="regexError" class="tool-error" style="display: none;"></div>
            </div>
        </section>

        <section id="features">
            <div class="container">
                <h2>Why Choose Our Google Sheets Guide?</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <span class="icon">üí°</span>
                        <h3>Simplify Complex Formulas</h3>
                        <p>Our Formula Generator translates your plain language needs into working Google Sheets formulas, saving you time and effort.</p>
                    </div>
                    <div class="feature-card">
                        <span class="icon">üîç</span>
                        <h3>Master REGEX Patterns</h3>
                        <p>The REGEX Builder provides an interactive environment to create and test regular expressions for precise data extraction and matching.</p>
                    </div>
                    <div class="feature-card">
                        <span class="icon">üìà</span>
                        <h3>Boost Your Productivity</h3>
                        <p>Learn advanced techniques and shortcuts that will streamline your workflows and make data analysis faster and more efficient.</p>
                    </div>
                    <div class="feature-card">
                        <span class="icon">üìö</span>
                        <h3>Comprehensive Learning</h3>
                        <p>Access an extensive library of tutorials, tips, and best practices covering everything from basic functions to advanced scripting.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="about">
            <div class="container">
                <h2>About SheetsGuide</h2>
                <p>SheetsGuide is dedicated to empowering users of all skill levels to harness the full power of Google Sheets. We believe that robust data management and analysis shouldn't be daunting. Our platform combines in-depth guides with innovative interactive tools to make learning practical and engaging.</p>
                <p>Our mission is to demystify Google Sheets, providing clear, actionable content and tools that help you solve real-world data challenges. From everyday tasks to complex data manipulation, SheetsGuide is your trusted partner for mastering spreadsheets.</p>
            </div>
        </section>

        <section id="contact">
            <div class="container">
                <h2>Get In Touch</h2>
                <div class="contact-content">
                    <div class="contact-form-container">
                        <h3>Send Us a Message</h3>
                        <form class="contact-form">
                            <label for="contactName">Name:</label>
                            <input type="text" id="contactName" placeholder="Your Name" required>

                            <label for="contactEmail">Email:</label>
                            <input type="email" id="contactEmail" placeholder="your@example.com" required>

                            <label for="contactMessage">Message:</label>
                            <textarea id="contactMessage" placeholder="Your message..." required></textarea>

                            <button type="submit" class="btn">Send Message</button>
                        </form>
                    </div>
                    <div class="contact-info">
                        <h3>Contact Information</h3>
                        <p><span class="icon-email"></span> <strong>Email:</strong> <a href="mailto:info@sheetsguide.example.com">info@sheetsguide.example.com</a></p>
                        <p><span class="icon-phone"></span> <strong>Phone:</strong> +1 (555) 123-4567</p>
                        <div class="social-links">
                            <a href="#" aria-label="Twitter"><span class="icon-twitter"></span></a>
                            <a href="#" aria-label="LinkedIn"><span class="icon-linkedin"></span></a>
                            <a href="#" aria-label="GitHub"><span class="icon-github"></span></a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; <span id="currentYear"></span> SheetsGuide. All rights reserved.</p>
            <ul class="footer-nav">
                <li><a href="#hero">Home</a></li>
                <li><a href="#formula-generator">Tools</a></li>
                <li><a href="#features">Features</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
            <div class="footer-social-links">
                <a href="#" aria-label="Twitter"><span class="icon-twitter"></span></a>
                <a href="#" aria-label="LinkedIn"><span class="icon-linkedin"></span></a>
                <a href="#" aria-label="Facebook"><span class="icon-facebook"></span></a>
            </div>
            <a href="#header" class="back-to-top">Back to Top</a>
        </div>
    </footer>

    <script>
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Universal Copy to Clipboard Function
        function copyToClipboard(elementId) {
            const outputElement = document.getElementById(elementId);
            const textToCopy = outputElement.textContent || outputElement.value; // Handle code block or input field

            navigator.clipboard.writeText(textToCopy).then(() => {
                const copyBtn = outputElement.closest('.tool-results').querySelector('.copy-btn');
                const originalText = copyBtn.textContent;
                copyBtn.textContent = 'Copied!';
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy: ', err);
                alert('Failed to copy formula. Please copy manually.');
            });
        }

        // --- Google Sheets Formula Generator Logic ---
        document.getElementById('formulaGenForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const goal = document.getElementById('formulaGoal').value.trim();
            const headersInput = document.getElementById('formulaHeaders').value.trim();
            const startRow = parseInt(document.getElementById('formulaStartRow').value, 10);

            const formulaOutput = document.getElementById('formulaOutput');
            const formulaResultDiv = document.getElementById('formulaResult');
            const formulaErrorDiv = document.getElementById('formulaError');

            formulaResultDiv.style.display = 'none';
            formulaErrorDiv.style.display = 'none';
            formulaOutput.textContent = '';

            if (!goal) {
                formulaErrorDiv.textContent = 'Please describe your goal.';
                formulaErrorDiv.style.display = 'block';
                return;
            }
            if (isNaN(startRow) || startRow < 1) {
                formulaErrorDiv.textContent = 'Starting row must be a positive number.';
                formulaErrorDiv.style.display = 'block';
                return;
            }

            let generatedFormula = '';
            const headers = headersInput ? headersInput.split(',').map(h => h.trim().toLowerCase()) : [];

            // Helper to convert header name to column letter
            function getColumnLetter(headerName) {
                const index = headers.indexOf(headerName.toLowerCase());
                if (index === -1) return null; // Header not found
                // Convert 0-indexed column index to A-Z letter
                let col = '';
                let temp = index;
                while (temp >= 0) {
                    col = String.fromCharCode(65 + (temp % 26)) + col;
                    temp = Math.floor(temp / 26) - 1;
                }
                return col;
            }

            // Simple keyword-based formula generation
            if (/sum column (\w+)(?: if column (\w+) is (["']?)(.*?)\3)?(?: and column (\w+) is (["']?)(.*?)\6)?/i.test(goal)) {
                const match = goal.match(/sum column (\w+)(?: if column (\w+) is (["']?)(.*?)\3)?(?: and column (\w+) is (["']?)(.*?)\6)?/i);
                let sumCol = getColumnLetter(match[1]) || match[1].toUpperCase();
                let criteria1Col = match[2] ? (getColumnLetter(match[2]) || match[2].toUpperCase()) : null;
                let criteria1Val = match[4];
                let criteria2Col = match[5] ? (getColumnLetter(match[5]) || match[5].toUpperCase()) : null;
                let criteria2Val = match[7];

                if (criteria1Col && criteria2Col) {
                    // SUMIFS
                    generatedFormula = `=SUMIFS(${sumCol}:${sumCol}, ${criteria1Col}:${criteria1Col}, "${criteria1Val}", ${criteria2Col}:${criteria2Col}, "${criteria2Val}")`;
                } else if (criteria1Col) {
                    // SUMIF
                    generatedFormula = `=SUMIF(${criteria1Col}:${criteria1Col}, "${criteria1Val}", ${sumCol}:${sumCol})`;
                } else {
                    // Simple SUM
                    generatedFormula = `=SUM(${sumCol}:${sumCol})`;
                }
            } else if (/average column (\w+)(?: where column (\w+) is ([<>=!]{0,2}\s*\d+))?/i.test(goal)) {
                const match = goal.match(/average column (\w+)(?: where column (\w+) is ([<>=!]{0,2}\s*\d+))?/i);
                let avgCol = getColumnLetter(match[1]) || match[1].toUpperCase();
                let criteriaCol = match[2] ? (getColumnLetter(match[2]) || match[2].toUpperCase()) : null;
                let criteriaVal = match[3];

                if (criteriaCol && criteriaVal) {
                    generatedFormula = `=AVERAGEIF(${criteriaCol}:${criteriaCol}, "${criteriaVal}", ${avgCol}:${avgCol})`;
                } else {
                    generatedFormula = `=AVERAGE(${avgCol}:${avgCol})`;
                }
            } else if (/count unique values in column (\w+)/i.test(goal)) {
                const match = goal.match(/count unique values in column (\w+)/i);
                let col = getColumnLetter(match[1]) || match[1].toUpperCase();
                generatedFormula = `=COUNTA(UNIQUE(${col}:${col}))`;
            } else if (/count (?:values|rows) in column (\w+)(?: if column (\w+) is (["']?)(.*?)\3)?/i.test(goal)) {
                 const match = goal.match(/count (?:values|rows) in column (\w+)(?: if column (\w+) is (["']?)(.*?)\3)?/i);
                 let countCol = getColumnLetter(match[1]) || match[1].toUpperCase();
                 let criteriaCol = match[2] ? (getColumnLetter(match[2]) || match[2].toUpperCase()) : null;
                 let criteriaVal = match[4];

                 if (criteriaCol && criteriaVal) {
                    generatedFormula = `=COUNTIF(${criteriaCol}:${criteriaCol}, "${criteriaVal}")`;
                 } else {
                    generatedFormula = `=COUNTA(${countCol}:${countCol})`;
                 }
            } else if (/concatenate (?:cells? )?(\w+)(\d+)? and (\w+)(\d+)?(?: with (["']?)(.*?)\6)?/i.test(goal)) {
                const match = goal.match(/concatenate (?:cells? )?(\w+)(\d+)? and (\w+)(\d+)?(?: with (["']?)(.*?)\6)?/i);
                let col1 = getColumnLetter(match[1]) || match[1].toUpperCase();
                let row1 = match[2] || startRow;
                let col2 = getColumnLetter(match[3]) || match[3].toUpperCase();
                let row2 = match[4] || startRow;
                let separator = match[7] || " "; // Default to space

                generatedFormula = `=CONCATENATE(${col1}${row1}, "${separator}", ${col2}${row2})`;
            } else if (/extract (?:numbers|emails|phone numbers) from column (\w+)/i.test(goal)) {
                const match = goal.match(/extract (?:numbers|emails|phone numbers) from column (\w+)/i);
                let col = getColumnLetter(match[1]) || match[1].toUpperCase();
                let pattern = '';
                if (/numbers/i.test(match[0])) pattern = '\\d+';
                else if (/emails/i.test(match[0])) pattern = '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}';
                else if (/phone numbers/i.test(match[0])) pattern = '\\d{3}[-. ]?\\d{3}[-. ]?\\d{4}'; // Simple phone pattern

                generatedFormula = `=ARRAYFORMULA(REGEXEXTRACT(${col}:${col}, "${pattern}"))`;
            } else if (/find "([^"]+)" in column (\w+)/i.test(goal)) {
                const match = goal.match(/find "([^"]+)" in column (\w+)/i);
                let textToFind = match[1];
                let col = getColumnLetter(match[2]) || match[2].toUpperCase();
                generatedFormula = `=IFERROR(FILTER(${col}:${col}, SEARCH("${textToFind}", ${col}:${col})), "Not Found")`;
            } else {
                generatedFormula = "Could not generate a specific formula. Please rephrase your goal or try a simpler request (e.g., 'sum column A if column B is Sales').";
            }

            formulaOutput.textContent = generatedFormula;
            formulaResultDiv.style.display = 'block';
        });

        // --- REGEX Formula Builder Logic ---
        document.getElementById('regexBuilderForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const pattern = document.getElementById('regexPattern').value;
            const testString = document.getElementById('regexTestString').value;
            const func = document.getElementById('regexFunction').value;
            const replacement = document.getElementById('regexReplacement').value;

            const regexOutput = document.getElementById('regexOutput');
            const regexResultDiv = document.getElementById('regexResult');
            const regexErrorDiv = document.getElementById('regexError');

            regexResultDiv.style.display = 'none';
            regexErrorDiv.style.display = 'none';
            regexOutput.textContent = '';

            if (!pattern) {
                regexErrorDiv.textContent = 'Please enter a REGEX pattern.';
                regexErrorDiv.style.display = 'block';
                return;
            }
            if (!testString) {
                regexErrorDiv.textContent = 'Please enter a test string.';
                regexErrorDiv.style.display = 'block';
                return;
            }

            try {
                const regex = new RegExp(pattern, 'g'); // 'g' for global matching where applicable
                let resultText = '';
                let sheetFormula = '';

                switch (func) {
                    case 'REGEXMATCH':
                        const isMatch = regex.test(testString);
                        resultText = `Matches: ${isMatch}`;
                        sheetFormula = `=REGEXMATCH("${testString}", "${pattern}")`;
                        break;
                    case 'REGEXEXTRACT':
                        const matches = testString.match(regex);
                        if (matches) {
                            resultText = 'Extracted Matches:\n';
                            matches.forEach((m, i) => {
                                resultText += `Group ${i + 1}: "${m}"\n`;
                            });
                        } else {
                            resultText = 'No matches found.';
                        }
                        sheetFormula = `=REGEXEXTRACT("${testString}", "${pattern}")`;
                        break;
                    case 'REGEXREPLACE':
                        const replacedString = testString.replace(regex, replacement);
                        resultText = `Original: "${testString}"\nReplaced: "${replacedString}"`;
                        sheetFormula = `=REGEXREPLACE("${testString}", "${pattern}", "${replacement}")`;
                        break;
                }
                regexOutput.textContent = `${resultText}\n\nGoogle Sheets Formula:\n${sheetFormula}`;
                regexResultDiv.style.display = 'block';

            } catch (e) {
                regexErrorDiv.textContent = `Invalid REGEX pattern: ${e.message}`;
                regexErrorDiv.style.display = 'block';
            }
        });

        document.getElementById('regexFunction').addEventListener('change', function() {
            const replaceField = document.getElementById('replaceField');
            if (this.value === 'REGEXREPLACE') {
                replaceField.style.display = 'block';
            } else {
                replaceField.style.display = 'none';
            }
        });

        // Close mobile nav on link click
        document.querySelectorAll('.nav-menu a').forEach(link => {
            link.addEventListener('click', () => {
                const navToggle = document.getElementById('nav-toggle');
                if (navToggle.checked) {
                    navToggle.checked = false;
                }
            });
        });

    </script>
</body>
</html>